<!DOCTYPE html>
<html>
<head>
  <!-- Standard Meta -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Zhenhai Dashboard</title>

  <link rel="stylesheet" type="text/css" href="/assets/sementicUI/css/semantic.css">
  <link rel="stylesheet" type="text/css" href="/assets/custom/css/custom.css">
  <link rel="stylesheet" type="text/css" href="/assets/jQueryUI/jquery-ui.min.css">

  <script src="/assets/lib/javascript/jquery-2.1.1.js"></script>
  <script src="/assets/sementicUI/semantic.js"></script>
  <script src="/assets/jQueryUI/jquery-ui.min.js"></script>
  <script src="/assets/lib/javascript/jquery.mtz.monthpicker.js"></script>

</head>
<body>
  <div class="ui fixed transparent inverted main menu">
    <div class="container">
      <a href="/" class="item"><div class="ui header">Zhenhai Dashboard</div></a>
      <div class="right menu">
        <div class="item">Information Center</div>
        <div class="ui simple dropdown item">
          <div><i class="ui large list icon"></i></div>
          <div class="menu">
            <!-- <a class="item" href="/user">個人頁</a> -->
            <a class="item" href="/user/logout"><i class="ui sign out icon"></i> 登出</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="ui page grid" style="padding-top:60px; padding-bottom:20px">

    <div class="column">

       <a class="ui right floated labled icon button"><i class="barcode icon"></i> 產生員工條碼</a>
       <a href="/management/addWorker" class="ui right floated labled icon button"><i class="plus icon"></i> 新增員工資料</a>

       <div style="clear: both"></div>

       <div id="tab" style="margin-top: 1em;">
         <div class="">
           <div class="ui top attached tabular menu">
             <% 
                 for (var i = 0; i < departments.length; i++) { 
             %>
                   <a class="<%= i == 0 ? 'active' : '' %> item" data-tab="<%= departments[i] %>"><%= departments[i] %></a>
             <%  } %>
           </div>
             <%
                 for (var key in departmentMapping) {
                   var activeClass = departmentMapping[key].active ? 'active' : '';
             %>
                   <div class="ui bottom attached <%= activeClass %> tab segment" data-tab="<%= key %>">
                   <table class="ui four column celled table">
                     <thead>
                       <tr><th>姓名</th><th>工號</th><th>組別</th><th>動作</th></tr>
                     </thead>
                     <tbody>
       
             <%
                   for (var i = 0; i < departmentMapping[key].workers.length; i++) {
                     var worker = departmentMapping[key].workers[i];
             %>
                           <tr id="row-<%= worker.id %>">
                             <td><%= worker.name %></td>
                             <td><%= worker.workerID %></td>
                             <td><%= worker.team %></td>
       
                             <td>
                               <div class="ui small buttons">
                                 <a href="/management/editWorker/<%= worker.id %>" class="ui icon button"><i class="ui edit icon"></i> 編輯</a>
                                 <div class="or"></div>
                                 <a href="javascript: deleteWorker('<%= worker.id %>', '<%= worker.name %>');" class="ui icon button"><i class="ui trash icon"></i> 刪除</a>
                               </div>
                             </td>
                           </tr>
             <%
                   }
             %>
                     </tbody>
                   </table>
                 </div>
             <%
                 }
             %>
       
       
         </div>
         <script>
           $('#tab .menu .item').tab({context: $('#tab')});
         </script>
       </div>
    </div>
  </div>
  <script>

    function deleteWorker(objectID, name) {
      var result = confirm("確定要刪除員工【" + name + "】嗎？");
      if (result) {
        $.ajax({
          url: "/management/deleteWorker",
          method: "POST",
          data: {objectID: objectID, _csrf: '<%= _csrf %>'},
        }).done(function() {
          $('#row-' + objectID).remove();
        });
      }
    }
  </script>
</body>
</html>
